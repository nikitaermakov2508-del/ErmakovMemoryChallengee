<Window x:Class="ErmakovMemoryChallenge.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Memory Trainer" Height="750" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        FontFamily="Segoe UI"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize">

    <WindowChrome.WindowChrome>
        <WindowChrome 
            ResizeBorderThickness="5"
            CaptionHeight="0"
            CornerRadius="0"
            GlassFrameThickness="0"/>
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <Style x:Key="ModernCardButton" TargetType="Button">
            <Setter Property="Background" Value="#7B1FA2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="BorderBrush" Value="#4A148C"/>
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="100"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#6A1B9A"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#E1BEE7"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4A148C"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="#7B1FA2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="Margin" Value="8,5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#6A1B9A"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4A148C"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#7B1FA2"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <Style x:Key="CloseButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#E1BEE7"/>
            <Setter Property="BorderBrush" Value="#7B1FA2"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Width" Value="30"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="15">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF5252"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#FF8A80"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#D32F2F"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="RadioButtonStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="#E1BEE7"/>
            <Setter Property="BorderBrush" Value="#7B1FA2"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#7B1FA2"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#E1BEE7"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#6A1B9A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="InfoText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#E1BEE7"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>

        <Style x:Key="HeaderText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#CE93D8"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style x:Key="ValueText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#69F0AE"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="SettingsText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#999999"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>

        <Style x:Key="SettingsHeader" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#AAAAAA"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#7B1FA2"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="5,0"/>
        </Style>

        <Style x:Key="PanelBorder" TargetType="Border">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="BorderBrush" Value="#7B1FA2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15"/>
        </Style>
    </Window.Resources>

    <Border Background="#1E1E1E" CornerRadius="10">
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Style="{StaticResource PanelBorder}" Margin="0,0,0,10"
                    MouseLeftButtonDown="TopPanel_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Режим:" Style="{StaticResource HeaderText}" Margin="0,0,10,0" Height="24"/>
                        <RadioButton x:Name="NormalModeButton" Content="Обычная игра" 
                                      Style="{StaticResource RadioButtonStyle}" IsChecked="True"
                                      Checked="NormalModeButton_Checked"/>
                        <RadioButton x:Name="ChallengeModeButton" Content="Испытание" 
                                      Style="{StaticResource RadioButtonStyle}"
                                      Checked="ChallengeModeButton_Checked"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                        <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                            <TextBlock Text="Уровень:" Style="{StaticResource HeaderText}" Margin="0,0,5,0" Height="19"/>
                            <TextBlock x:Name="LevelText" Text="-" Style="{StaticResource ValueText}" Height="16"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Время:" Style="{StaticResource HeaderText}" Margin="0,0,5,0" Height="19"/>
                            <TextBlock x:Name="TimerText" Text="00:00" Style="{StaticResource ValueText}" 
                                       FontSize="16" Foreground="#69F0AE" Height="18"/>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="⚙" Style="{StaticResource SecondaryButton}"
                                Click="SettingsButton_Click" Padding="8" Margin="0,0,8,0"/>
                        <Button x:Name="CloseButton" Content="X" Style="{StaticResource CloseButtonStyle}" 
                                Click="CloseButton_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <Border Grid.Row="1" Style="{StaticResource PanelBorder}" Margin="0,0,0,10">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                        <TextBlock Text="Ходы:" Style="{StaticResource HeaderText}" Margin="0,0,8,0"/>
                        <TextBlock x:Name="MovesText" Text="0" Style="{StaticResource ValueText}" FontSize="16" Height="18"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                        <TextBlock Text="Найдено пар:" Style="{StaticResource HeaderText}" Margin="0,0,8,0"/>
                        <TextBlock x:Name="PairsText" Text="0/0" Style="{StaticResource ValueText}" FontSize="16" Height="20"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Статус:" Style="{StaticResource HeaderText}" Margin="0,0,8,0"/>
                        <TextBlock x:Name="StatusText" Text="Готов к игре" Style="{StaticResource ValueText}" 
                                   Foreground="#FFD54F" FontSize="14" Height="19"/>
                    </StackPanel>
                </StackPanel>   
            </Border>

            <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                          Background="#252525" Padding="10" Margin="0,0,0,10">
                <UniformGrid x:Name="FieldGrid"/>
            </ScrollViewer>

            <Border Grid.Row="3" Style="{StaticResource PanelBorder}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="🎮 Новая игра" Style="{StaticResource PrimaryButton}" 
                            Click="NewGameButton_Click" FontSize="14"/>
                    <Button Content="🔄 Сброс" Style="{StaticResource SecondaryButton}" 
                            Click="ResetButton_Click" FontSize="14"/>
                </StackPanel>
            </Border>

            <Border Grid.Row="0" Grid.RowSpan="4" x:Name="SettingsPanel" 
                    Background="#CC000000" Panel.ZIndex="100" Visibility="Collapsed">
                <Border Style="{StaticResource PanelBorder}" Background="#2D2D30" 
                        BorderThickness="2" Padding="25" 
                        HorizontalAlignment="Center" VerticalAlignment="Center"
                        Width="450">
                    <StackPanel>
                        <TextBlock Text="Настройки игры" Style="{StaticResource SettingsHeader}" 
                                   FontSize="20" Margin="0,0,0,25" HorizontalAlignment="Center"/>

                        <StackPanel x:Name="NormalModeSettings" Margin="0,0,0,15">
                            <TextBlock Text="Размер поля:" Style="{StaticResource SettingsHeader}" Margin="0,0,0,8"/>
                            <ComboBox x:Name="FieldSizeComboBox" Style="{StaticResource ComboBoxStyle}">
                                <ComboBoxItem Content="2×3 (6 карточек)" Tag="2x3"/>
                                <ComboBoxItem Content="3×4 (12 карточек)" Tag="3x4" IsSelected="True"/>
                                <ComboBoxItem Content="4×4 (16 карточек)" Tag="4x4"/>
                                <ComboBoxItem Content="4×5 (20 карточек)" Tag="4x5"/>
                                <ComboBoxItem Content="5×6 (30 карточек)" Tag="5x6"/>
                                <ComboBoxItem Content="6×6 (36 карточек)" Tag="6x6"/>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel x:Name="ChallengeModeInfo" Margin="0,0,0,15" Visibility="Collapsed">
                            <TextBlock Text="Режим испытания" Style="{StaticResource SettingsHeader}" Margin="0,0,0,8"/>
                            <TextBlock Text="Прогрессивная система: начинаете с маленького поля и переходите к большему. Всего 6 уровней." 
                                       Style="{StaticResource SettingsText}" TextWrapping="Wrap" Margin="0,5,0,0"/>
                            <TextBlock Text="Текущий прогресс сбрасывается при начале новой игры." 
                                       Style="{StaticResource SettingsText}" TextWrapping="Wrap" Margin="0,5,0,0" Foreground="#FFD54F"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,15">
                            <TextBlock Text="Сложность:" Style="{StaticResource SettingsHeader}" Margin="0,0,0,8"/>
                            <ComboBox x:Name="DifficultyComboBox" Style="{StaticResource ComboBoxStyle}">
                                <ComboBoxItem Content="Легкий - 5 секунд" Tag="Easy"/>
                                <ComboBoxItem Content="Средний - 3 секунды" Tag="Medium" IsSelected="True"/>
                                <ComboBoxItem Content="Сложный - 2 секунды" Tag="Hard"/>
                                <ComboBoxItem Content="Эксперт - 1 секунда" Tag="Expert"/>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,25">
                            <TextBlock Text="Тип контента:" Style="{StaticResource SettingsHeader}" Margin="0,0,0,8"/>
                            <ComboBox x:Name="ContentTypeComboBox" Style="{StaticResource ComboBoxStyle}">
                                <ComboBoxItem Content="🔢 Цифры" Tag="Numbers" IsSelected="True"/>
                                <ComboBoxItem Content="🔣 Символы" Tag="Symbols"/>
                            </ComboBox>
                        </StackPanel>

                        <Button Content="✅ Применить настройки" Style="{StaticResource PrimaryButton}" 
                                Click="ApplySettingsButton_Click" FontSize="14" HorizontalAlignment="Stretch"/>
                        <Button Content="❌ Закрыть" Style="{StaticResource SecondaryButton}" 
                                Click="CloseSettingsButton_Click" FontSize="14" Margin="0,8,0,0" Cursor="Hand"/>
                    </StackPanel>
                </Border>
            </Border>
        </Grid>
    </Border>
</Window>